% setwd("SpecificationSims/Writeup/")
\documentclass{article}
\usepackage{graphicx, color}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\definecolor{fgcolor}{rgb}{0.267, 0.267, 0.267}
\newcommand{\hlnumber}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlfunctioncall}[1]{\textcolor[rgb]{0.501960784313725,0,0.329411764705882}{\textbf{#1}}}%
\newcommand{\hlstring}[1]{\textcolor[rgb]{0.6,0.6,1}{#1}}%
\newcommand{\hlkeyword}[1]{\textcolor[rgb]{0,0,0}{\textbf{#1}}}%
\newcommand{\hlargument}[1]{\textcolor[rgb]{0.690196078431373,0.250980392156863,0.0196078431372549}{#1}}%
\newcommand{\hlcomment}[1]{\textcolor[rgb]{0.180392156862745,0.6,0.341176470588235}{#1}}%
\newcommand{\hlroxygencomment}[1]{\textcolor[rgb]{0.43921568627451,0.47843137254902,0.701960784313725}{#1}}%
\newcommand{\hlformalargs}[1]{\textcolor[rgb]{0.690196078431373,0.250980392156863,0.0196078431372549}{#1}}%
\newcommand{\hleqformalargs}[1]{\textcolor[rgb]{0.690196078431373,0.250980392156863,0.0196078431372549}{#1}}%
\newcommand{\hlassignement}[1]{\textcolor[rgb]{0,0,0}{\textbf{#1}}}%
\newcommand{\hlpackage}[1]{\textcolor[rgb]{0.588235294117647,0.709803921568627,0.145098039215686}{#1}}%
\newcommand{\hlslot}[1]{\textit{#1}}%
\newcommand{\hlsymbol}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlprompt}[1]{\textcolor[rgb]{0.266666666666667,0.266666666666667,0.266666666666667}{#1}}%

\usepackage{color}%
 
\newsavebox{\hlnormalsizeboxclosebrace}%
\newsavebox{\hlnormalsizeboxopenbrace}%
\newsavebox{\hlnormalsizeboxbackslash}%
\newsavebox{\hlnormalsizeboxlessthan}%
\newsavebox{\hlnormalsizeboxgreaterthan}%
\newsavebox{\hlnormalsizeboxdollar}%
\newsavebox{\hlnormalsizeboxunderscore}%
\newsavebox{\hlnormalsizeboxand}%
\newsavebox{\hlnormalsizeboxhash}%
\newsavebox{\hlnormalsizeboxat}%
\newsavebox{\hlnormalsizeboxpercent}% 
\newsavebox{\hlnormalsizeboxhat}%
\newsavebox{\hlnormalsizeboxsinglequote}%
\newsavebox{\hlnormalsizeboxbacktick}%

\setbox\hlnormalsizeboxopenbrace=\hbox{\begin{normalsize}\verb.{.\end{normalsize}}%
\setbox\hlnormalsizeboxclosebrace=\hbox{\begin{normalsize}\verb.}.\end{normalsize}}%
\setbox\hlnormalsizeboxlessthan=\hbox{\begin{normalsize}\verb.<.\end{normalsize}}%
\setbox\hlnormalsizeboxdollar=\hbox{\begin{normalsize}\verb.$.\end{normalsize}}%
\setbox\hlnormalsizeboxunderscore=\hbox{\begin{normalsize}\verb._.\end{normalsize}}%
\setbox\hlnormalsizeboxand=\hbox{\begin{normalsize}\verb.&.\end{normalsize}}%
\setbox\hlnormalsizeboxhash=\hbox{\begin{normalsize}\verb.#.\end{normalsize}}%
\setbox\hlnormalsizeboxat=\hbox{\begin{normalsize}\verb.@.\end{normalsize}}%
\setbox\hlnormalsizeboxbackslash=\hbox{\begin{normalsize}\verb.\.\end{normalsize}}%
\setbox\hlnormalsizeboxgreaterthan=\hbox{\begin{normalsize}\verb.>.\end{normalsize}}%
\setbox\hlnormalsizeboxpercent=\hbox{\begin{normalsize}\verb.%.\end{normalsize}}%
\setbox\hlnormalsizeboxhat=\hbox{\begin{normalsize}\verb.^.\end{normalsize}}%
\setbox\hlnormalsizeboxsinglequote=\hbox{\begin{normalsize}\verb.'.\end{normalsize}}%
\setbox\hlnormalsizeboxbacktick=\hbox{\begin{normalsize}\verb.`.\end{normalsize}}%
\setbox\hlnormalsizeboxhat=\hbox{\begin{normalsize}\verb.^.\end{normalsize}}%



\newsavebox{\hltinyboxclosebrace}%
\newsavebox{\hltinyboxopenbrace}%
\newsavebox{\hltinyboxbackslash}%
\newsavebox{\hltinyboxlessthan}%
\newsavebox{\hltinyboxgreaterthan}%
\newsavebox{\hltinyboxdollar}%
\newsavebox{\hltinyboxunderscore}%
\newsavebox{\hltinyboxand}%
\newsavebox{\hltinyboxhash}%
\newsavebox{\hltinyboxat}%
\newsavebox{\hltinyboxpercent}% 
\newsavebox{\hltinyboxhat}%
\newsavebox{\hltinyboxsinglequote}%
\newsavebox{\hltinyboxbacktick}%

\setbox\hltinyboxopenbrace=\hbox{\begin{tiny}\verb.{.\end{tiny}}%
\setbox\hltinyboxclosebrace=\hbox{\begin{tiny}\verb.}.\end{tiny}}%
\setbox\hltinyboxlessthan=\hbox{\begin{tiny}\verb.<.\end{tiny}}%
\setbox\hltinyboxdollar=\hbox{\begin{tiny}\verb.$.\end{tiny}}%
\setbox\hltinyboxunderscore=\hbox{\begin{tiny}\verb._.\end{tiny}}%
\setbox\hltinyboxand=\hbox{\begin{tiny}\verb.&.\end{tiny}}%
\setbox\hltinyboxhash=\hbox{\begin{tiny}\verb.#.\end{tiny}}%
\setbox\hltinyboxat=\hbox{\begin{tiny}\verb.@.\end{tiny}}%
\setbox\hltinyboxbackslash=\hbox{\begin{tiny}\verb.\.\end{tiny}}%
\setbox\hltinyboxgreaterthan=\hbox{\begin{tiny}\verb.>.\end{tiny}}%
\setbox\hltinyboxpercent=\hbox{\begin{tiny}\verb.%.\end{tiny}}%
\setbox\hltinyboxhat=\hbox{\begin{tiny}\verb.^.\end{tiny}}%
\setbox\hltinyboxsinglequote=\hbox{\begin{tiny}\verb.'.\end{tiny}}%
\setbox\hltinyboxbacktick=\hbox{\begin{tiny}\verb.`.\end{tiny}}%
\setbox\hltinyboxhat=\hbox{\begin{tiny}\verb.^.\end{tiny}}%



\newsavebox{\hlscriptsizeboxclosebrace}%
\newsavebox{\hlscriptsizeboxopenbrace}%
\newsavebox{\hlscriptsizeboxbackslash}%
\newsavebox{\hlscriptsizeboxlessthan}%
\newsavebox{\hlscriptsizeboxgreaterthan}%
\newsavebox{\hlscriptsizeboxdollar}%
\newsavebox{\hlscriptsizeboxunderscore}%
\newsavebox{\hlscriptsizeboxand}%
\newsavebox{\hlscriptsizeboxhash}%
\newsavebox{\hlscriptsizeboxat}%
\newsavebox{\hlscriptsizeboxpercent}% 
\newsavebox{\hlscriptsizeboxhat}%
\newsavebox{\hlscriptsizeboxsinglequote}%
\newsavebox{\hlscriptsizeboxbacktick}%

\setbox\hlscriptsizeboxopenbrace=\hbox{\begin{scriptsize}\verb.{.\end{scriptsize}}%
\setbox\hlscriptsizeboxclosebrace=\hbox{\begin{scriptsize}\verb.}.\end{scriptsize}}%
\setbox\hlscriptsizeboxlessthan=\hbox{\begin{scriptsize}\verb.<.\end{scriptsize}}%
\setbox\hlscriptsizeboxdollar=\hbox{\begin{scriptsize}\verb.$.\end{scriptsize}}%
\setbox\hlscriptsizeboxunderscore=\hbox{\begin{scriptsize}\verb._.\end{scriptsize}}%
\setbox\hlscriptsizeboxand=\hbox{\begin{scriptsize}\verb.&.\end{scriptsize}}%
\setbox\hlscriptsizeboxhash=\hbox{\begin{scriptsize}\verb.#.\end{scriptsize}}%
\setbox\hlscriptsizeboxat=\hbox{\begin{scriptsize}\verb.@.\end{scriptsize}}%
\setbox\hlscriptsizeboxbackslash=\hbox{\begin{scriptsize}\verb.\.\end{scriptsize}}%
\setbox\hlscriptsizeboxgreaterthan=\hbox{\begin{scriptsize}\verb.>.\end{scriptsize}}%
\setbox\hlscriptsizeboxpercent=\hbox{\begin{scriptsize}\verb.%.\end{scriptsize}}%
\setbox\hlscriptsizeboxhat=\hbox{\begin{scriptsize}\verb.^.\end{scriptsize}}%
\setbox\hlscriptsizeboxsinglequote=\hbox{\begin{scriptsize}\verb.'.\end{scriptsize}}%
\setbox\hlscriptsizeboxbacktick=\hbox{\begin{scriptsize}\verb.`.\end{scriptsize}}%
\setbox\hlscriptsizeboxhat=\hbox{\begin{scriptsize}\verb.^.\end{scriptsize}}%



\newsavebox{\hlfootnotesizeboxclosebrace}%
\newsavebox{\hlfootnotesizeboxopenbrace}%
\newsavebox{\hlfootnotesizeboxbackslash}%
\newsavebox{\hlfootnotesizeboxlessthan}%
\newsavebox{\hlfootnotesizeboxgreaterthan}%
\newsavebox{\hlfootnotesizeboxdollar}%
\newsavebox{\hlfootnotesizeboxunderscore}%
\newsavebox{\hlfootnotesizeboxand}%
\newsavebox{\hlfootnotesizeboxhash}%
\newsavebox{\hlfootnotesizeboxat}%
\newsavebox{\hlfootnotesizeboxpercent}% 
\newsavebox{\hlfootnotesizeboxhat}%
\newsavebox{\hlfootnotesizeboxsinglequote}%
\newsavebox{\hlfootnotesizeboxbacktick}%

\setbox\hlfootnotesizeboxopenbrace=\hbox{\begin{footnotesize}\verb.{.\end{footnotesize}}%
\setbox\hlfootnotesizeboxclosebrace=\hbox{\begin{footnotesize}\verb.}.\end{footnotesize}}%
\setbox\hlfootnotesizeboxlessthan=\hbox{\begin{footnotesize}\verb.<.\end{footnotesize}}%
\setbox\hlfootnotesizeboxdollar=\hbox{\begin{footnotesize}\verb.$.\end{footnotesize}}%
\setbox\hlfootnotesizeboxunderscore=\hbox{\begin{footnotesize}\verb._.\end{footnotesize}}%
\setbox\hlfootnotesizeboxand=\hbox{\begin{footnotesize}\verb.&.\end{footnotesize}}%
\setbox\hlfootnotesizeboxhash=\hbox{\begin{footnotesize}\verb.#.\end{footnotesize}}%
\setbox\hlfootnotesizeboxat=\hbox{\begin{footnotesize}\verb.@.\end{footnotesize}}%
\setbox\hlfootnotesizeboxbackslash=\hbox{\begin{footnotesize}\verb.\.\end{footnotesize}}%
\setbox\hlfootnotesizeboxgreaterthan=\hbox{\begin{footnotesize}\verb.>.\end{footnotesize}}%
\setbox\hlfootnotesizeboxpercent=\hbox{\begin{footnotesize}\verb.%.\end{footnotesize}}%
\setbox\hlfootnotesizeboxhat=\hbox{\begin{footnotesize}\verb.^.\end{footnotesize}}%
\setbox\hlfootnotesizeboxsinglequote=\hbox{\begin{footnotesize}\verb.'.\end{footnotesize}}%
\setbox\hlfootnotesizeboxbacktick=\hbox{\begin{footnotesize}\verb.`.\end{footnotesize}}%
\setbox\hlfootnotesizeboxhat=\hbox{\begin{footnotesize}\verb.^.\end{footnotesize}}%



\newsavebox{\hlsmallboxclosebrace}%
\newsavebox{\hlsmallboxopenbrace}%
\newsavebox{\hlsmallboxbackslash}%
\newsavebox{\hlsmallboxlessthan}%
\newsavebox{\hlsmallboxgreaterthan}%
\newsavebox{\hlsmallboxdollar}%
\newsavebox{\hlsmallboxunderscore}%
\newsavebox{\hlsmallboxand}%
\newsavebox{\hlsmallboxhash}%
\newsavebox{\hlsmallboxat}%
\newsavebox{\hlsmallboxpercent}% 
\newsavebox{\hlsmallboxhat}%
\newsavebox{\hlsmallboxsinglequote}%
\newsavebox{\hlsmallboxbacktick}%

\setbox\hlsmallboxopenbrace=\hbox{\begin{small}\verb.{.\end{small}}%
\setbox\hlsmallboxclosebrace=\hbox{\begin{small}\verb.}.\end{small}}%
\setbox\hlsmallboxlessthan=\hbox{\begin{small}\verb.<.\end{small}}%
\setbox\hlsmallboxdollar=\hbox{\begin{small}\verb.$.\end{small}}%
\setbox\hlsmallboxunderscore=\hbox{\begin{small}\verb._.\end{small}}%
\setbox\hlsmallboxand=\hbox{\begin{small}\verb.&.\end{small}}%
\setbox\hlsmallboxhash=\hbox{\begin{small}\verb.#.\end{small}}%
\setbox\hlsmallboxat=\hbox{\begin{small}\verb.@.\end{small}}%
\setbox\hlsmallboxbackslash=\hbox{\begin{small}\verb.\.\end{small}}%
\setbox\hlsmallboxgreaterthan=\hbox{\begin{small}\verb.>.\end{small}}%
\setbox\hlsmallboxpercent=\hbox{\begin{small}\verb.%.\end{small}}%
\setbox\hlsmallboxhat=\hbox{\begin{small}\verb.^.\end{small}}%
\setbox\hlsmallboxsinglequote=\hbox{\begin{small}\verb.'.\end{small}}%
\setbox\hlsmallboxbacktick=\hbox{\begin{small}\verb.`.\end{small}}%
\setbox\hlsmallboxhat=\hbox{\begin{small}\verb.^.\end{small}}%



\newsavebox{\hllargeboxclosebrace}%
\newsavebox{\hllargeboxopenbrace}%
\newsavebox{\hllargeboxbackslash}%
\newsavebox{\hllargeboxlessthan}%
\newsavebox{\hllargeboxgreaterthan}%
\newsavebox{\hllargeboxdollar}%
\newsavebox{\hllargeboxunderscore}%
\newsavebox{\hllargeboxand}%
\newsavebox{\hllargeboxhash}%
\newsavebox{\hllargeboxat}%
\newsavebox{\hllargeboxpercent}% 
\newsavebox{\hllargeboxhat}%
\newsavebox{\hllargeboxsinglequote}%
\newsavebox{\hllargeboxbacktick}%

\setbox\hllargeboxopenbrace=\hbox{\begin{large}\verb.{.\end{large}}%
\setbox\hllargeboxclosebrace=\hbox{\begin{large}\verb.}.\end{large}}%
\setbox\hllargeboxlessthan=\hbox{\begin{large}\verb.<.\end{large}}%
\setbox\hllargeboxdollar=\hbox{\begin{large}\verb.$.\end{large}}%
\setbox\hllargeboxunderscore=\hbox{\begin{large}\verb._.\end{large}}%
\setbox\hllargeboxand=\hbox{\begin{large}\verb.&.\end{large}}%
\setbox\hllargeboxhash=\hbox{\begin{large}\verb.#.\end{large}}%
\setbox\hllargeboxat=\hbox{\begin{large}\verb.@.\end{large}}%
\setbox\hllargeboxbackslash=\hbox{\begin{large}\verb.\.\end{large}}%
\setbox\hllargeboxgreaterthan=\hbox{\begin{large}\verb.>.\end{large}}%
\setbox\hllargeboxpercent=\hbox{\begin{large}\verb.%.\end{large}}%
\setbox\hllargeboxhat=\hbox{\begin{large}\verb.^.\end{large}}%
\setbox\hllargeboxsinglequote=\hbox{\begin{large}\verb.'.\end{large}}%
\setbox\hllargeboxbacktick=\hbox{\begin{large}\verb.`.\end{large}}%
\setbox\hllargeboxhat=\hbox{\begin{large}\verb.^.\end{large}}%



\newsavebox{\hlLargeboxclosebrace}%
\newsavebox{\hlLargeboxopenbrace}%
\newsavebox{\hlLargeboxbackslash}%
\newsavebox{\hlLargeboxlessthan}%
\newsavebox{\hlLargeboxgreaterthan}%
\newsavebox{\hlLargeboxdollar}%
\newsavebox{\hlLargeboxunderscore}%
\newsavebox{\hlLargeboxand}%
\newsavebox{\hlLargeboxhash}%
\newsavebox{\hlLargeboxat}%
\newsavebox{\hlLargeboxpercent}% 
\newsavebox{\hlLargeboxhat}%
\newsavebox{\hlLargeboxsinglequote}%
\newsavebox{\hlLargeboxbacktick}%

\setbox\hlLargeboxopenbrace=\hbox{\begin{Large}\verb.{.\end{Large}}%
\setbox\hlLargeboxclosebrace=\hbox{\begin{Large}\verb.}.\end{Large}}%
\setbox\hlLargeboxlessthan=\hbox{\begin{Large}\verb.<.\end{Large}}%
\setbox\hlLargeboxdollar=\hbox{\begin{Large}\verb.$.\end{Large}}%
\setbox\hlLargeboxunderscore=\hbox{\begin{Large}\verb._.\end{Large}}%
\setbox\hlLargeboxand=\hbox{\begin{Large}\verb.&.\end{Large}}%
\setbox\hlLargeboxhash=\hbox{\begin{Large}\verb.#.\end{Large}}%
\setbox\hlLargeboxat=\hbox{\begin{Large}\verb.@.\end{Large}}%
\setbox\hlLargeboxbackslash=\hbox{\begin{Large}\verb.\.\end{Large}}%
\setbox\hlLargeboxgreaterthan=\hbox{\begin{Large}\verb.>.\end{Large}}%
\setbox\hlLargeboxpercent=\hbox{\begin{Large}\verb.%.\end{Large}}%
\setbox\hlLargeboxhat=\hbox{\begin{Large}\verb.^.\end{Large}}%
\setbox\hlLargeboxsinglequote=\hbox{\begin{Large}\verb.'.\end{Large}}%
\setbox\hlLargeboxbacktick=\hbox{\begin{Large}\verb.`.\end{Large}}%
\setbox\hlLargeboxhat=\hbox{\begin{Large}\verb.^.\end{Large}}%



\newsavebox{\hlLARGEboxclosebrace}%
\newsavebox{\hlLARGEboxopenbrace}%
\newsavebox{\hlLARGEboxbackslash}%
\newsavebox{\hlLARGEboxlessthan}%
\newsavebox{\hlLARGEboxgreaterthan}%
\newsavebox{\hlLARGEboxdollar}%
\newsavebox{\hlLARGEboxunderscore}%
\newsavebox{\hlLARGEboxand}%
\newsavebox{\hlLARGEboxhash}%
\newsavebox{\hlLARGEboxat}%
\newsavebox{\hlLARGEboxpercent}% 
\newsavebox{\hlLARGEboxhat}%
\newsavebox{\hlLARGEboxsinglequote}%
\newsavebox{\hlLARGEboxbacktick}%

\setbox\hlLARGEboxopenbrace=\hbox{\begin{LARGE}\verb.{.\end{LARGE}}%
\setbox\hlLARGEboxclosebrace=\hbox{\begin{LARGE}\verb.}.\end{LARGE}}%
\setbox\hlLARGEboxlessthan=\hbox{\begin{LARGE}\verb.<.\end{LARGE}}%
\setbox\hlLARGEboxdollar=\hbox{\begin{LARGE}\verb.$.\end{LARGE}}%
\setbox\hlLARGEboxunderscore=\hbox{\begin{LARGE}\verb._.\end{LARGE}}%
\setbox\hlLARGEboxand=\hbox{\begin{LARGE}\verb.&.\end{LARGE}}%
\setbox\hlLARGEboxhash=\hbox{\begin{LARGE}\verb.#.\end{LARGE}}%
\setbox\hlLARGEboxat=\hbox{\begin{LARGE}\verb.@.\end{LARGE}}%
\setbox\hlLARGEboxbackslash=\hbox{\begin{LARGE}\verb.\.\end{LARGE}}%
\setbox\hlLARGEboxgreaterthan=\hbox{\begin{LARGE}\verb.>.\end{LARGE}}%
\setbox\hlLARGEboxpercent=\hbox{\begin{LARGE}\verb.%.\end{LARGE}}%
\setbox\hlLARGEboxhat=\hbox{\begin{LARGE}\verb.^.\end{LARGE}}%
\setbox\hlLARGEboxsinglequote=\hbox{\begin{LARGE}\verb.'.\end{LARGE}}%
\setbox\hlLARGEboxbacktick=\hbox{\begin{LARGE}\verb.`.\end{LARGE}}%
\setbox\hlLARGEboxhat=\hbox{\begin{LARGE}\verb.^.\end{LARGE}}%



\newsavebox{\hlhugeboxclosebrace}%
\newsavebox{\hlhugeboxopenbrace}%
\newsavebox{\hlhugeboxbackslash}%
\newsavebox{\hlhugeboxlessthan}%
\newsavebox{\hlhugeboxgreaterthan}%
\newsavebox{\hlhugeboxdollar}%
\newsavebox{\hlhugeboxunderscore}%
\newsavebox{\hlhugeboxand}%
\newsavebox{\hlhugeboxhash}%
\newsavebox{\hlhugeboxat}%
\newsavebox{\hlhugeboxpercent}% 
\newsavebox{\hlhugeboxhat}%
\newsavebox{\hlhugeboxsinglequote}%
\newsavebox{\hlhugeboxbacktick}%

\setbox\hlhugeboxopenbrace=\hbox{\begin{huge}\verb.{.\end{huge}}%
\setbox\hlhugeboxclosebrace=\hbox{\begin{huge}\verb.}.\end{huge}}%
\setbox\hlhugeboxlessthan=\hbox{\begin{huge}\verb.<.\end{huge}}%
\setbox\hlhugeboxdollar=\hbox{\begin{huge}\verb.$.\end{huge}}%
\setbox\hlhugeboxunderscore=\hbox{\begin{huge}\verb._.\end{huge}}%
\setbox\hlhugeboxand=\hbox{\begin{huge}\verb.&.\end{huge}}%
\setbox\hlhugeboxhash=\hbox{\begin{huge}\verb.#.\end{huge}}%
\setbox\hlhugeboxat=\hbox{\begin{huge}\verb.@.\end{huge}}%
\setbox\hlhugeboxbackslash=\hbox{\begin{huge}\verb.\.\end{huge}}%
\setbox\hlhugeboxgreaterthan=\hbox{\begin{huge}\verb.>.\end{huge}}%
\setbox\hlhugeboxpercent=\hbox{\begin{huge}\verb.%.\end{huge}}%
\setbox\hlhugeboxhat=\hbox{\begin{huge}\verb.^.\end{huge}}%
\setbox\hlhugeboxsinglequote=\hbox{\begin{huge}\verb.'.\end{huge}}%
\setbox\hlhugeboxbacktick=\hbox{\begin{huge}\verb.`.\end{huge}}%
\setbox\hlhugeboxhat=\hbox{\begin{huge}\verb.^.\end{huge}}%



\newsavebox{\hlHugeboxclosebrace}%
\newsavebox{\hlHugeboxopenbrace}%
\newsavebox{\hlHugeboxbackslash}%
\newsavebox{\hlHugeboxlessthan}%
\newsavebox{\hlHugeboxgreaterthan}%
\newsavebox{\hlHugeboxdollar}%
\newsavebox{\hlHugeboxunderscore}%
\newsavebox{\hlHugeboxand}%
\newsavebox{\hlHugeboxhash}%
\newsavebox{\hlHugeboxat}%
\newsavebox{\hlHugeboxpercent}% 
\newsavebox{\hlHugeboxhat}%
\newsavebox{\hlHugeboxsinglequote}%
\newsavebox{\hlHugeboxbacktick}%

\setbox\hlHugeboxopenbrace=\hbox{\begin{Huge}\verb.{.\end{Huge}}%
\setbox\hlHugeboxclosebrace=\hbox{\begin{Huge}\verb.}.\end{Huge}}%
\setbox\hlHugeboxlessthan=\hbox{\begin{Huge}\verb.<.\end{Huge}}%
\setbox\hlHugeboxdollar=\hbox{\begin{Huge}\verb.$.\end{Huge}}%
\setbox\hlHugeboxunderscore=\hbox{\begin{Huge}\verb._.\end{Huge}}%
\setbox\hlHugeboxand=\hbox{\begin{Huge}\verb.&.\end{Huge}}%
\setbox\hlHugeboxhash=\hbox{\begin{Huge}\verb.#.\end{Huge}}%
\setbox\hlHugeboxat=\hbox{\begin{Huge}\verb.@.\end{Huge}}%
\setbox\hlHugeboxbackslash=\hbox{\begin{Huge}\verb.\.\end{Huge}}%
\setbox\hlHugeboxgreaterthan=\hbox{\begin{Huge}\verb.>.\end{Huge}}%
\setbox\hlHugeboxpercent=\hbox{\begin{Huge}\verb.%.\end{Huge}}%
\setbox\hlHugeboxhat=\hbox{\begin{Huge}\verb.^.\end{Huge}}%
\setbox\hlHugeboxsinglequote=\hbox{\begin{Huge}\verb.'.\end{Huge}}%
\setbox\hlHugeboxbacktick=\hbox{\begin{Huge}\verb.`.\end{Huge}}%
\setbox\hlHugeboxhat=\hbox{\begin{Huge}\verb.^.\end{Huge}}%
 

\def\urltilda{\kern -.15em\lower .7ex\hbox{\~{}}\kern .04em}%

\newcommand{\hlstd}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.16,0.16,1}{#1}}
\newcommand{\hlesc}[1]{\textcolor[rgb]{1,0,1}{#1}}
\newcommand{\hlstr}[1]{\textcolor[rgb]{1,0,0}{#1}}
\newcommand{\hldstr}[1]{\textcolor[rgb]{0.51,0.51,0}{#1}}
\newcommand{\hlslc}[1]{\textcolor[rgb]{0.51,0.51,0.51}{\it{#1}}}
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.51,0.51,0.51}{\it{#1}}}
\newcommand{\hldir}[1]{\textcolor[rgb]{0,0.51,0}{#1}}
\newcommand{\hlsym}[1]{\textcolor[rgb]{0,0,0}{#1}}
\newcommand{\hlline}[1]{\textcolor[rgb]{0.33,0.33,0.33}{#1}}
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0,0,0}{\bf{#1}}}
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.51,0,0}{#1}}
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0,0,0}{\bf{#1}}}
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0,0,0.51}{#1}}


\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage[height = 9in, top = 1in, width = 6.3 in]{geometry}
\usepackage{verbatim, amsmath, amsthm, amssymb}
% Palatino for rm and math | Helvetica for ss | Courier for tt
\usepackage{mathpazo} % math & rm
\linespread{1.05}        % Palatino needs more leading (space between lines)
\usepackage[scaled]{helvet} % ss
\usepackage{courier} % tt
\normalfont
\usepackage[T1]{fontenc}

\title{A Monte Carlo Investigation of Locally Weighted Regression}
\author{Aaron Swoboda and Sam Carruthers}
\begin{document}

\maketitle

This document writes up the results of the recent run of \texttt{uberScript.R}. It contains the following code:

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }set{\ }our{\ }simulation{\ }parameters}\hspace*{\fill}\\
\hlstd{}\hlsymbol{Replications}{\ }\hlassignement{=}{\ }\hlnumber{100}\hspace*{\fill}\\
\hlstd{}\hlsymbol{sample.size}{\ }\hlassignement{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{50}\hlkeyword{,}{\ }\hlnumber{100}\hlkeyword{,}{\ }\hlnumber{200}\hlkeyword{,}{\ }\hlnumber{500}\hlkeyword{,}{\ }\hlnumber{1000}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{error.sd}{\ }\hlassignement{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{2}\hlkeyword{,}{\ }\hlnumber{4}\hlkeyword{,}{\ }\hlnumber{6}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{B1.spatial.var}{\ }\hlassignement{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{.1}\hlkeyword{,}{\ }\hlnumber{.2}\hlkeyword{,}{\ }\hlnumber{.3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{B2.spatial.var}{\ }\hlassignement{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{.1}\hlkeyword{,}{\ }\hlnumber{.2}\hlkeyword{,}{\ }\hlnumber{.3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }now{\ }march{\ }through{\ }the{\ }different{\ }parameter{\ }combinations{\ }running{\ }the{\ }simulations}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlkeyword{for}\hlkeyword{(}{\ }\hlsymbol{i}{\ }\hlkeyword{in}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{meta.sim.num}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }\hlsymbol{start}{\ }\hlassignement{=}{\ }\hlfunctioncall{Sys.time}\hlkeyword{(}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }\hlsymbol{simRepOut}{\ }\hlassignement{=}{\ }\hlfunctioncall{simulationReplicator}\hlkeyword{(}\hlsymbol{Replications}\hlkeyword{,}{\ }\hlsymbol{sim.parameters}\hlkeyword{[}\hlsymbol{i}\hlkeyword{,}{\ }\hlkeyword{]}\hlkeyword{,}{\ }\hlargument{MC}{\ }\hlargument{=}{\ }\hlnumber{TRUE}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }\hlsymbol{simOut}{\ }\hlassignement{=}{\ }\hlfunctioncall{simRepReorganizer}\hlkeyword{(}\hlsymbol{simRepOut}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }\hlsymbol{R2Output}\hlkeyword{[}\hlfunctioncall{as.character}\hlkeyword{(}\hlsymbol{sim.parameters}\hlkeyword{[}\hlsymbol{i}\hlkeyword{,}{\ }\hlstring{"{}sample.size"{}}\hlkeyword{]}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlfunctioncall{as.character}\hlkeyword{(}\hlsymbol{sim.parameters}\hlkeyword{[}\hlsymbol{i}\hlkeyword{,}{\ }\hlstring{"{}error.sd"{}}\hlkeyword{]}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlfunctioncall{as.character}\hlkeyword{(}\hlsymbol{sim.parameters}\hlkeyword{[}\hlsymbol{i}\hlkeyword{,}{\ }\hlstring{"{}B1.spatial.var"{}}\hlkeyword{]}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlfunctioncall{as.character}\hlkeyword{(}\hlsymbol{sim.parameters}\hlkeyword{[}\hlsymbol{i}\hlkeyword{,}{\ }\hlstring{"{}B2.spatial.var"{}}\hlkeyword{]}\hlkeyword{)}\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{]}{\ }\hlassignement{=}{\ }\hlsymbol{simOut}\hlkeyword{[[}\hlnumber{1}\hlkeyword{]}\hlkeyword{]}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }\hlsymbol{MetricOutput}\hlkeyword{[}\hlfunctioncall{as.character}\hlkeyword{(}\hlsymbol{sim.parameters}\hlkeyword{[}\hlsymbol{i}\hlkeyword{,}{\ }\hlstring{"{}sample.size"{}}\hlkeyword{]}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlfunctioncall{as.character}\hlkeyword{(}\hlsymbol{sim.parameters}\hlkeyword{[}\hlsymbol{i}\hlkeyword{,}{\ }\hlstring{"{}error.sd"{}}\hlkeyword{]}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlfunctioncall{as.character}\hlkeyword{(}\hlsymbol{sim.parameters}\hlkeyword{[}\hlsymbol{i}\hlkeyword{,}{\ }\hlstring{"{}B1.spatial.var"{}}\hlkeyword{]}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlfunctioncall{as.character}\hlkeyword{(}\hlsymbol{sim.parameters}\hlkeyword{[}\hlsymbol{i}\hlkeyword{,}{\ }\hlstring{"{}B2.spatial.var"{}}\hlkeyword{]}\hlkeyword{)}\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{]}{\ }\hlassignement{=}{\ }\hlsymbol{simOut}\hlkeyword{[[}\hlnumber{2}\hlkeyword{]}\hlkeyword{]}\hspace*{\fill}\\
\hlstd{}{\ }{\ }\hlsymbol{end}{\ }\hlassignement{=}{\ }\hlfunctioncall{Sys.time}\hlkeyword{(}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }\hlfunctioncall{print}\hlkeyword{(}\hlfunctioncall{paste}\hlkeyword{(}\hlstring{"{}For{\ }loop"{}}\hlkeyword{,}{\ }\hlsymbol{i}\hlkeyword{,}\hlstring{"{}of"{}}\hlkeyword{,}{\ }\hlsymbol{meta.sim.num}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }\hlfunctioncall{print}\hlkeyword{(}\hlfunctioncall{round}\hlkeyword{(}\hlfunctioncall{difftime}\hlkeyword{(}\hlsymbol{end}\hlkeyword{,}{\ }\hlsymbol{start}\hlkeyword{,}{\ }\hlargument{units}{\ }\hlargument{=}{\ }\hlstring{"{}m"{}}\hlkeyword{)}\hlkeyword{,}{\ }\hlnumber{2}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }\hlfunctioncall{save}\hlkeyword{(}\hlsymbol{R2Output}\hlkeyword{,}{\ }\hlsymbol{MetricOutput}\hlkeyword{,}{\ }\hlargument{file}{\ }\hlargument{=}{\ }\hlstring{"{}SpecificationSims/uberScriptOutput.RData"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\mbox{}
\normalfont
\end{flushleft}
\end{kframe}
\end{knitrout}


I'm not going to run that code here (it took almost a month to run on the R Server), but let's load up the results and start to look at them. Or at least come up with some questions to ask of the data and a plan for the future.
\newpage
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlfunctioncall{load}\hlkeyword{(}\hlstring{"{}../Data/uberScriptOutput20120919.RData"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{dimnames}\hlkeyword{(}\hlsymbol{MetricOutput}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## $ss
## [1] "50"   "100"  "200"  "500"  "1000"
## 
## $error.sd
## [1] "2" "4" "6"
## 
## $B1sv
## [1] "0"   "0.1" "0.2" "0.3"
## 
## $B2sv
## [1] "0"   "0.1" "0.2" "0.3"
## 
## $simNum
##   [1] "1"   "2"   "3"   "4"   "5"   "6"   "7"   "8"   "9"   "10"  "11" 
##  [12] "12"  "13"  "14"  "15"  "16"  "17"  "18"  "19"  "20"  "21"  "22" 
##  [23] "23"  "24"  "25"  "26"  "27"  "28"  "29"  "30"  "31"  "32"  "33" 
##  [34] "34"  "35"  "36"  "37"  "38"  "39"  "40"  "41"  "42"  "43"  "44" 
##  [45] "45"  "46"  "47"  "48"  "49"  "50"  "51"  "52"  "53"  "54"  "55" 
##  [56] "56"  "57"  "58"  "59"  "60"  "61"  "62"  "63"  "64"  "65"  "66" 
##  [67] "67"  "68"  "69"  "70"  "71"  "72"  "73"  "74"  "75"  "76"  "77" 
##  [78] "78"  "79"  "80"  "81"  "82"  "83"  "84"  "85"  "86"  "87"  "88" 
##  [89] "89"  "90"  "91"  "92"  "93"  "94"  "95"  "96"  "97"  "98"  "99" 
## [100] "100"
## 
## $optimized
##  [1] "AICc"     "corB0"    "corB1"    "corB2"    "CV"       "GCV"     
##  [7] "R2"       "RMSE.B0"  "RMSE.B1"  "RMSE.B2"  "SCV"      "ttest%B0"
## [13] "ttest%B1" "ttest%B2"
## 
## $metric
##  [1] "bandwidths" "B0.cor"     "B1.cor"     "B2.cor"     "B0.RMSE"   
##  [6] "B1.RMSE"    "B2.RMSE"    "B0.t.perc"  "B1.t.perc"  "B2.t.perc" 
## [11] "GCV"        "SCV"        "CV"         "AICc"       "R2"        
## 
\end{verbatim}
\begin{flushleft}
\ttfamily\noindent
\hlfunctioncall{dimnames}\hlkeyword{(}\hlsymbol{R2Output}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## $ss
## [1] "50"   "100"  "200"  "500"  "1000"
## 
## $error.sd
## [1] "2" "4" "6"
## 
## $B1sv
## [1] "0"   "0.1" "0.2" "0.3"
## 
## $B2sv
## [1] "0"   "0.1" "0.2" "0.3"
## 
## $simNum
##   [1] "1"   "2"   "3"   "4"   "5"   "6"   "7"   "8"   "9"   "10"  "11" 
##  [12] "12"  "13"  "14"  "15"  "16"  "17"  "18"  "19"  "20"  "21"  "22" 
##  [23] "23"  "24"  "25"  "26"  "27"  "28"  "29"  "30"  "31"  "32"  "33" 
##  [34] "34"  "35"  "36"  "37"  "38"  "39"  "40"  "41"  "42"  "43"  "44" 
##  [45] "45"  "46"  "47"  "48"  "49"  "50"  "51"  "52"  "53"  "54"  "55" 
##  [56] "56"  "57"  "58"  "59"  "60"  "61"  "62"  "63"  "64"  "65"  "66" 
##  [67] "67"  "68"  "69"  "70"  "71"  "72"  "73"  "74"  "75"  "76"  "77" 
##  [78] "78"  "79"  "80"  "81"  "82"  "83"  "84"  "85"  "86"  "87"  "88" 
##  [89] "89"  "90"  "91"  "92"  "93"  "94"  "95"  "96"  "97"  "98"  "99" 
## [100] "100"
## 
## $R2
## [1] "OLS" "LWR"
## 
\end{verbatim}
\end{kframe}
\end{knitrout}


So, we ran some simulations, varying the sample size of the data set, the standard deviation of the error term in the model and the degree of spatial variation in the model coefficients. 

Each simulation was conducted as follows:
\begin{enumerate}
\item Grab the simulation parameters.
\item Generate the data according to the model and parameters. 
\item Choose a number of observations to include in the Locally Weighted Regression.
\item Run Locally Weighted Regression on the data using the chosen bandwidth for each observation within the dataset.
\item Calculate a number of model metrics for each bandwidth
\item Repeat previous two steps for a number of bandwidths, ranging from only 5 data points to a model approaching a global Ordinary Least Squares model (in our case, we still had declining weights based on distance, but all observations received positive weight in the regresssion).
\item Collect data on each metric when each metric is optimized. For instance, when we choose the bandwidth associated with the lowest GCV score, what are the other metric values ($\beta$ RMSEs, etc.)
\end{enumerate}

We kept track of the following model performance metrics, the pseudo $R^2$ of the model results, the correlation between the $\hat{\beta}$ and the true $\beta$, the percent of the observations for which we can reject the null hypothesis that $\hat{\beta}=\beta$, cross validation scores (leave one out, generalized, and standardized according to Paez), lastly the AIC score.

\subsection{Data Generation Process}

The Data Generation Process is achieved using the \texttt{DataGen} function, the code for which is given below. 
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlfunctioncall{source}\hlkeyword{(}\hlstring{"{}../SimFunctions.R"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{DataGen}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## function (sample.size, error.sd, B1.spatial.var, B2.spatial.var) 
## {
##     n = sample.size
##     east = runif(sample.size) * 10
##     north = runif(sample.size) * 10
##     indep.var1 = runif(sample.size) * 10
##     indep.var2 = runif(sample.size) * 10
##     trueB0 = 0
##     trueB1 = B1.spatial.var * north + 1 - 5 * B1.spatial.var
##     trueB2 = B2.spatial.var * east + 1 - 5 * B2.spatial.var
##     error = rnorm(sample.size, 0, error.sd)
##     dep.var = trueB0 + indep.var1 * trueB1 + indep.var2 * trueB2 + 
##         error
##     output = data.frame(dep.var, north, east, indep.var1, indep.var2, 
##         trueB0, trueB1, trueB2, error)
##     output
## }
\end{verbatim}
\end{kframe}
\end{knitrout}


The dependent variable is produced as follows:
\begin{equation}
Y = \beta _0 + \beta _1(location) X_1 + \beta _2(location) X_2 + error
\end{equation}
where $error \sim n(0, \sigma ^2)$. Each observation is located within a geographic coordinate system $(east, north)$ where both $east$ and $north$ values are $\sim u(0, 10)$. The functions determining $\beta _1$ and $\beta _2$ are :
\begin{eqnarray}
\beta _1 (east, north) &=& 1 + Bsv1 * north - 5*Bsv1 \\
\beta _2 (east, north) &=& 1 + Bsv2 * east - 5*Bsv2
\end{eqnarray}
In our simulations we let $Bsv_i$ vary $\{0, 0.1, 0.2, 0.3\}$, thus the relationship between $\beta$s and location can be visualized as:

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlsymbol{east}{\ }\hlassignement{=}{\ }\hlsymbol{north}{\ }\hlassignement{=}{\ }\hlnumber{0}\hlkeyword{:}\hlnumber{10}\hspace*{\fill}\\
\hlstd{}\hlsymbol{BetaFunc}{\ }\hlassignement{=}{\ }\hlkeyword{function}\hlkeyword{(}\hlformalargs{x}\hlkeyword{,}{\ }\hlformalargs{Bsv}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlnumber{1}{\ }\hlkeyword{+}{\ }\hlsymbol{Bsv}{\ }\hlkeyword{*}{\ }\hlsymbol{x}{\ }\hlkeyword{-}{\ }\hlnumber{5}{\ }\hlkeyword{*}{\ }\hlsymbol{Bsv}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{par}\hlkeyword{(}\hlargument{mfrow}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{1}\hlkeyword{,}{\ }\hlnumber{2}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{plot}\hlkeyword{(}\hlsymbol{north}\hlkeyword{,}{\ }\hlfunctioncall{BetaFunc}\hlkeyword{(}\hlsymbol{north}\hlkeyword{,}{\ }\hlnumber{0.3}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{type}{\ }\hlargument{=}{\ }\hlstring{"{}l"{}}\hlkeyword{,}{\ }\hlargument{xlab}{\ }\hlargument{=}{\ }\hlstring{"{}north"{}}\hlkeyword{,}{\ }\hlargument{ylab}{\ }\hlargument{=}{\ }\hlstring{"{}True{\ }Beta"{}}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlargument{main}{\ }\hlargument{=}{\ }\hlfunctioncall{expression}\hlkeyword{(}\hlfunctioncall{paste}\hlkeyword{(}\hlstring{"{}True{\ }"{}}\hlkeyword{,}{\ }\hlsymbol{beta}\hlkeyword{[}\hlnumber{1}\hlkeyword{]}\hlkeyword{,}{\ }\hlstring{"{}{\ }over{\ }Space"{}}\hlkeyword{)}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{lines}\hlkeyword{(}\hlsymbol{north}\hlkeyword{,}{\ }\hlfunctioncall{BetaFunc}\hlkeyword{(}\hlsymbol{north}\hlkeyword{,}{\ }\hlnumber{0.2}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlstring{"{}red"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{lines}\hlkeyword{(}\hlsymbol{north}\hlkeyword{,}{\ }\hlfunctioncall{BetaFunc}\hlkeyword{(}\hlsymbol{north}\hlkeyword{,}{\ }\hlnumber{0.1}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlstring{"{}blue"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{lines}\hlkeyword{(}\hlsymbol{north}\hlkeyword{,}{\ }\hlfunctioncall{BetaFunc}\hlkeyword{(}\hlsymbol{north}\hlkeyword{,}{\ }\hlnumber{0}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlstring{"{}orange"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{text}\hlkeyword{(}\hlfunctioncall{rep}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{4}\hlkeyword{)}\hlkeyword{,}{\ }\hlfunctioncall{seq}\hlkeyword{(}\hlnumber{0.925}\hlkeyword{,}{\ }\hlkeyword{-}\hlnumber{0.5}\hlkeyword{,}{\ }\hlargument{length}{\ }\hlargument{=}{\ }\hlnumber{4}\hlkeyword{)}\hlkeyword{,}{\ }\hlfunctioncall{paste}\hlkeyword{(}\hlstring{"{}Bsv1="{}}\hlkeyword{,}{\ }\hlkeyword{(}\hlnumber{0}\hlkeyword{:}\hlnumber{3}\hlkeyword{)}\hlkeyword{/}\hlnumber{10}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlargument{pos}{\ }\hlargument{=}{\ }\hlnumber{4}\hlkeyword{,}{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlstring{"{}orange"{}}\hlkeyword{,}{\ }\hlstring{"{}blue"{}}\hlkeyword{,}{\ }\hlstring{"{}red"{}}\hlkeyword{,}{\ }\hlstring{"{}black"{}}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{cex}{\ }\hlargument{=}{\ }\hlnumber{0.7}\hlkeyword{,}{\ }\hlargument{offset}{\ }\hlargument{=}{\ }\hlnumber{0}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{plot}\hlkeyword{(}\hlsymbol{east}\hlkeyword{,}{\ }\hlfunctioncall{BetaFunc}\hlkeyword{(}\hlsymbol{east}\hlkeyword{,}{\ }\hlnumber{0.3}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{type}{\ }\hlargument{=}{\ }\hlstring{"{}l"{}}\hlkeyword{,}{\ }\hlargument{xlab}{\ }\hlargument{=}{\ }\hlstring{"{}east"{}}\hlkeyword{,}{\ }\hlargument{ylab}{\ }\hlargument{=}{\ }\hlstring{"{}True{\ }Beta"{}}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlargument{main}{\ }\hlargument{=}{\ }\hlfunctioncall{expression}\hlkeyword{(}\hlfunctioncall{paste}\hlkeyword{(}\hlstring{"{}True{\ }"{}}\hlkeyword{,}{\ }\hlsymbol{beta}\hlkeyword{[}\hlnumber{2}\hlkeyword{]}\hlkeyword{,}{\ }\hlstring{"{}{\ }over{\ }Space"{}}\hlkeyword{)}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{lines}\hlkeyword{(}\hlsymbol{east}\hlkeyword{,}{\ }\hlfunctioncall{BetaFunc}\hlkeyword{(}\hlsymbol{east}\hlkeyword{,}{\ }\hlnumber{0.2}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlstring{"{}red"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{lines}\hlkeyword{(}\hlsymbol{east}\hlkeyword{,}{\ }\hlfunctioncall{BetaFunc}\hlkeyword{(}\hlsymbol{east}\hlkeyword{,}{\ }\hlnumber{0.1}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlstring{"{}blue"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{lines}\hlkeyword{(}\hlsymbol{east}\hlkeyword{,}{\ }\hlfunctioncall{BetaFunc}\hlkeyword{(}\hlsymbol{east}\hlkeyword{,}{\ }\hlnumber{0}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlstring{"{}orange"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{text}\hlkeyword{(}\hlfunctioncall{rep}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{4}\hlkeyword{)}\hlkeyword{,}{\ }\hlfunctioncall{seq}\hlkeyword{(}\hlnumber{0.925}\hlkeyword{,}{\ }\hlkeyword{-}\hlnumber{0.5}\hlkeyword{,}{\ }\hlargument{length}{\ }\hlargument{=}{\ }\hlnumber{4}\hlkeyword{)}\hlkeyword{,}{\ }\hlfunctioncall{paste}\hlkeyword{(}\hlstring{"{}Bsv2="{}}\hlkeyword{,}{\ }\hlkeyword{(}\hlnumber{0}\hlkeyword{:}\hlnumber{3}\hlkeyword{)}\hlkeyword{/}\hlnumber{10}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlargument{pos}{\ }\hlargument{=}{\ }\hlnumber{4}\hlkeyword{,}{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlstring{"{}orange"{}}\hlkeyword{,}{\ }\hlstring{"{}blue"{}}\hlkeyword{,}{\ }\hlstring{"{}red"{}}\hlkeyword{,}{\ }\hlstring{"{}black"{}}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{cex}{\ }\hlargument{=}{\ }\hlnumber{0.7}\hlkeyword{,}{\ }\hlargument{offset}{\ }\hlargument{=}{\ }\hlnumber{0}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\end{kframe}\includegraphics{figure/SpatVarBeta} 
\end{knitrout}


Our simulations include data generation processes in which:
\begin{enumerate}
\item neither coefficient varies over space ($Bsv_1 = 0$ \& $Bsv_2 = 0$)
\item both coefficients vary over space ($Bsv_1 \neq 0$ \& $Bsv_2 \neq 0$)
\item only one coefficient varies over space ($Bsv_1 = 0$ \& $Bsv_2 \neq 0$ OR $Bsv_1 \neq 0$ \& $Bsv_2 = 0$)
\end{enumerate}

Each simulation can be characterized by our selection of four data generation parameters,
\begin{itemize}
\item sample size $\{50, 200, 500, 1000\}$
\item variance of the error term $\{2^2, 4^2, 6^2\}$
\item degree of spatial variation in $\beta _1$  $\{0, .1, .2, .3\}$
\item degree of spatial variation in $\beta _2$  $\{0, .1, .2, .3\}$
\end{itemize}

\section{Research Questions}
What do we want to know about LWR?

\begin{enumerate}
  \item Are there systematic differences in the bandwidth size selected by different techniques? How do LOOCV, Standardaized CV, Generalize CV, and the AICc compare?
  \item What sort of spatial variation in the coefficients is necessary relative to the error to need LWR?
  \item If there is no spatial relationship, will LWR default back to global OLS?
\end{enumerate}

\section{Applying Locally Weighted Regression}

After generating the data, we applied Locally Weighted Regression and calculated numerous diagnostics in order to measure the performance of the regression technique.

Locally Weighted Regression (LWR) is an estimation strategy allowing non-stationary model parameters. A vector of regression parameters is estimated using Equation~\eqref{eq:LWR} for each location within the dataset, 
\begin{equation}\label{eq:LWR}
\hat{\beta}_{location_i} =(X^TW_{location_i}X)^{-1}X^TW_{location_i}Y,
\end{equation}
where $X$ is the standard $n$ x $m$ data matrix, $Y$ the $n$ x $1$ vector of dependent variable values, and $W_{location_i}$ is an $n$ x $n$ weights matrix. We construct the weights matrix for a given location to give positive weights to the $k$-nearest data points, with weights declining according to a bi-square function as distances increase.  Specifically, we create the weights matrix with zeros on the off-diagonal and calculate the $jj$th diagonal element as,
\begin{equation}\label{eq:bisquare}
w_{ij}= 
\begin{cases} \left[1-\left(\frac{d_{ij}}{d_{ik}}\right)^2\right]^2 & \text{if $d_{ij}\leq d_{ik}$} \\
0 &\text{if $d_{ij} > d_{ik}$}
\end{cases}
\end{equation}
where $d_{ij}$ is the distance between observations $i$ and $j$, and $d_{ik}$ is the distance to the $k$th nearest observation to observation $i$.

\subsection{Cross-Validation}
Theory does not provide guidance as to how many observations should receive positive weights in the local regression and must be determined by the researcher for the problem at hand. Typically, the $k$ parameter is determined by minimizing a cross-validation metric. This research aims to systematically compare the performance of four different cross-validation metrics used in LWR research.
\begin{enumerate}
\item Leave-One-Out Cross-Validation
\item Generalized Cross-Validation 
\item Standardized Cross-Validation
\item Akaike Information Criterion
\end{enumerate}

Does choosing the optimal number of observations to include in the LWR through these four strategies yield similar results? If there are differences, are there patterns in how they are different?

\subsection{Leave-One Out Cross-Validation}

\begin{equation}
\sum (y - \hat{y}_{-i})^2
\end{equation}

\subsection{Generalized Cross-Validation Score}
\begin{equation}\label{eq:GCV}
  n*\sum_{i=1}^{n}\frac{(y_i-\hat{y}_i)^2}{(n-v_1)^2}, 
  \end{equation}
where $y_i$ is the dependent variable value, $\hat{y}_i$ is the predicted dependent variable value for observation $i$, and $v_1$ is the ``effective number of model parameters.''\footnote{
  $v_1=$tr(\textbf{S}), where the matrix \textbf{S} is the ``hat matrix'' which maps $y$ onto $\hat{y}$,
\begin{equation*}
  \hat{y}=\textbf{S}y,
  \end{equation*}
  and each row of \textbf{S}, $r_i$ is given by:
  \begin{equation*}
    r_i=X_i(X^TW(location_i)X)^{-1}X^TW(location_i).
    \end{equation*}
}
In an LWR model, the number of parameters to be estimated is no longer equal to the number of variables included because we allow the regression coefficients to vary over space. The GCV score calculates the ``effective'' number of model parameters, $v_1$, and penalizes the model for increasing the number of parameters without sufficient reduction in model accuracy. Taking the square root of Equation~\eqref{eq:GCV} and rearranging yields,
\begin{equation}
  \sqrt{GCV}=\sqrt{\frac{n}{n-v_1}} \sqrt{\frac{\textrm{Sum of Squared Residuals}}{n-v_1}},
\end{equation}
which approaches $\hat{\sigma}$ as $v_1$ approaches $m$ for large $n$. Henceforth, throughout the paper we report the square root of \eqref{eq:GCV} because of its similarity to $\hat{\sigma}$.  

\subsection{Row Standardized Cross-Validation}

Something about Paez, who wanted a CV score that was more robust to outliers.

\begin{equation}\label{eq:SCV}
\frac{\sum (y - y_{-i})^2} {\sum y}
\end{equation}

\subsection{Akaike Information Criterion}

\begin{equation}\label{eq:AIC}
  2*n*ln(\hat{\sigma}) + n*ln(2*\pi) + 
    n*\frac{n + v_1}{n - 2 - v_1}
    \end{equation}
    
\section{Which Bandwidths Do Selection Metrics Suggest?}

In this section we compare the bandwidth selected by the different metrics.

\subsection{Overall}

\begin{itemize}
\item What are some summary stats about the bandwidths selected by each metric? (table: row for each metric, column for min, median, mean, max, sd)
\item What is the visual distribution of bandwidths selected by each metric? (small multiples of a histogram for each metric)
\end{itemize}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlsymbol{mymetrics}{\ }\hlassignement{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlstring{"{}CV"{}}\hlkeyword{,}{\ }\hlstring{"{}GCV"{}}\hlkeyword{,}{\ }\hlstring{"{}SCV"{}}\hlkeyword{,}{\ }\hlstring{"{}AICc"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{summary.table}{\ }\hlassignement{=}{\ }\hlfunctioncall{matrix}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlfunctioncall{length}\hlkeyword{(}\hlsymbol{mymetrics}\hlkeyword{)}\hlkeyword{,}{\ }\hlnumber{7}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{for}{\ }\hlkeyword{(}\hlsymbol{mymetric}{\ }\hlkeyword{in}{\ }\hlsymbol{mymetrics}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlsymbol{summary.table}\hlkeyword{[}\hlfunctioncall{which}\hlkeyword{(}\hlsymbol{mymetrics}{\ }=={\ }\hlsymbol{mymetric}\hlkeyword{)}\hlkeyword{,}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{6}\hlkeyword{]}{\ }\hlassignement{=}{\ }\hlfunctioncall{summary}\hlkeyword{(}\hlsymbol{MetricOutput}\hlkeyword{[}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlsymbol{mymetric}\hlkeyword{,}{\ }\hlstring{"{}bandwidths"{}}\hlkeyword{]}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlsymbol{summary.table}\hlkeyword{[}\hlfunctioncall{which}\hlkeyword{(}\hlsymbol{mymetrics}{\ }=={\ }\hlsymbol{mymetric}\hlkeyword{)}\hlkeyword{,}{\ }\hlnumber{7}\hlkeyword{]}{\ }\hlassignement{=}{\ }\hlfunctioncall{sd}\hlkeyword{(}\hlsymbol{MetricOutput}\hlkeyword{[}\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlkeyword{,}{\ }\hlsymbol{mymetric}\hlkeyword{,}{\ }\hlstring{"{}bandwidths"{}}\hlkeyword{]}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{rownames}\hlkeyword{(}\hlsymbol{summary.table}\hlkeyword{)}{\ }\hlassignement{=}{\ }\hlsymbol{mymetrics}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{colnames}\hlkeyword{(}\hlsymbol{summary.table}\hlkeyword{)}{\ }\hlassignement{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlstring{"{}min"{}}\hlkeyword{,}{\ }\hlstring{"{}Q1"{}}\hlkeyword{,}{\ }\hlstring{"{}median"{}}\hlkeyword{,}{\ }\hlstring{"{}mean"{}}\hlkeyword{,}{\ }\hlstring{"{}Q3"{}}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlstring{"{}max"{}}\hlkeyword{,}{\ }\hlstring{"{}sd"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{print}\hlkeyword{(}\hlfunctioncall{round}\hlkeyword{(}\hlsymbol{summary.table}\hlkeyword{)}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
##      min Q1 median mean  Q3 max  sd
## CV    10 40     70  112 135 999 134
## GCV    5 40     70  111 135 999 134
## SCV   10 45     90  162 235 955 149
## AICc  15 45     80  121 145 999 134
\end{verbatim}
\end{kframe}
\end{knitrout}




Comparing the bandwidths at this level of aggregation is of limited use because we do not expect the same bandwidth to always be suggested. First, the bandwidth suggestion is constrained to be smaller than the sample size of the data, and so we should break out the simulation. Second, we expect the bandwidth selected to be a function of the degree of spatial variation in the underlying data generation process.

\subsection{Sample Size}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlsymbol{myss}{\ }\hlassignement{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlstring{"{}50"{}}\hlkeyword{,}{\ }\hlstring{"{}100"{}}\hlkeyword{,}{\ }\hlstring{"{}200"{}}\hlkeyword{,}{\ }\hlstring{"{}500"{}}\hlkeyword{,}{\ }\hlstring{"{}1000"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{mymetrics}{\ }\hlassignement{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlstring{"{}CV"{}}\hlkeyword{,}{\ }\hlstring{"{}GCV"{}}\hlkeyword{,}{\ }\hlstring{"{}SCV"{}}\hlkeyword{,}{\ }\hlstring{"{}AICc"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlkeyword{for}{\ }\hlkeyword{(}\hlsymbol{ssi}{\ }\hlkeyword{in}{\ }\hlsymbol{myss}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlsymbol{summary.table}{\ }\hlassignement{=}{\ }\hlfunctioncall{matrix}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlfunctioncall{length}\hlkeyword{(}\hlsymbol{mymetrics}\hlkeyword{)}\hlkeyword{,}{\ }\hlnumber{7}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlkeyword{for}{\ }\hlkeyword{(}\hlsymbol{mymetric}{\ }\hlkeyword{in}{\ }\hlsymbol{mymetrics}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlsymbol{summary.table}\hlkeyword{[}\hlfunctioncall{which}\hlkeyword{(}\hlsymbol{mymetrics}{\ }=={\ }\hlsymbol{mymetric}\hlkeyword{)}\hlkeyword{,}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{6}\hlkeyword{]}{\ }\hlassignement{=}{\ }\hlfunctioncall{summary}\hlkeyword{(}\hlsymbol{MetricOutput}\hlkeyword{[}\hlsymbol{ssi}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlsymbol{mymetric}\hlkeyword{,}{\ }\hlstring{"{}bandwidths"{}}\hlkeyword{]}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlsymbol{summary.table}\hlkeyword{[}\hlfunctioncall{which}\hlkeyword{(}\hlsymbol{mymetrics}{\ }=={\ }\hlsymbol{mymetric}\hlkeyword{)}\hlkeyword{,}{\ }\hlnumber{7}\hlkeyword{]}{\ }\hlassignement{=}{\ }\hlfunctioncall{sd}\hlkeyword{(}\hlsymbol{MetricOutput}\hlkeyword{[}\hlsymbol{ssi}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlsymbol{mymetric}\hlkeyword{,}{\ }\hlstring{"{}bandwidths"{}}\hlkeyword{]}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{rownames}\hlkeyword{(}\hlsymbol{summary.table}\hlkeyword{)}{\ }\hlassignement{=}{\ }\hlsymbol{mymetrics}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{colnames}\hlkeyword{(}\hlsymbol{summary.table}\hlkeyword{)}{\ }\hlassignement{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlstring{"{}min"{}}\hlkeyword{,}{\ }\hlstring{"{}Q1"{}}\hlkeyword{,}{\ }\hlstring{"{}median"{}}\hlkeyword{,}{\ }\hlstring{"{}mean"{}}\hlkeyword{,}{\ }\hlstring{"{}Q3"{}}\hlkeyword{,}{\ }\hlstring{"{}max"{}}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlstring{"{}sd"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{print}\hlkeyword{(}\hlfunctioncall{paste}\hlkeyword{(}\hlstring{"{}Sample{\ }Size{\ }="{}}\hlkeyword{,}{\ }\hlsymbol{ssi}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{print}\hlkeyword{(}\hlfunctioncall{round}\hlkeyword{(}\hlsymbol{summary.table}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [1] "Sample Size = 50"
##      min Q1 median mean Q3 max sd
## CV    10 20     30   31 40  49 12
## GCV    5 20     30   30 40  49 12
## SCV   10 25     30   29 35  49  8
## AICc  15 30     35   37 45  49  9
## [1] "Sample Size = 100"
##      min Q1 median mean Q3 max sd
## CV    10 30     45   50 65  99 24
## GCV    5 30     45   49 65  99 24
## SCV   15 45     50   51 60  99 13
## AICc  20 40     55   58 71  99 22
## [1] "Sample Size = 200"
##      min Q1 median mean  Q3 max sd
## CV    20 50     70   81 100 199 46
## GCV   15 45     70   80 100 199 46
## SCV   40 80     90   93 105 199 21
## AICc  30 55     80   90 110 199 44
## [1] "Sample Size = 500"
##      min  Q1 median mean  Q3 max  sd
## CV    30  85    120  151 170 499 107
## GCV   35  85    120  151 170 499 107
## SCV  100 190    215  217 235 480  38
## AICc  45  95    130  161 180 499 105
## [1] "Sample Size = 1000"
##      min  Q1 median mean  Q3 max  sd
## CV    55 130    185  246 260 999 210
## GCV   45 130    185  246 260 999 210
## SCV  255 380    420  421 455 955  62
## AICc  65 140    195  257 270 999 209
\end{verbatim}
\end{kframe}
\end{knitrout}


\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlfunctioncall{require}\hlkeyword{(}\hlsymbol{beanplot}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{require}\hlkeyword{(}\hlsymbol{RColorBrewer}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{mypal}{\ }\hlassignement{=}{\ }\hlfunctioncall{brewer.pal}\hlkeyword{(}\hlnumber{4}\hlkeyword{,}{\ }\hlstring{"{}Set2"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{par}\hlkeyword{(}\hlargument{mfrow}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{3}\hlkeyword{,}{\ }\hlnumber{2}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{par}\hlkeyword{(}\hlargument{oma}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{2}\hlkeyword{,}{\ }\hlnumber{0}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{par}\hlkeyword{(}\hlargument{mar}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{2}\hlkeyword{,}{\ }\hlnumber{4.5}\hlkeyword{,}{\ }\hlnumber{3}\hlkeyword{,}{\ }\hlnumber{0}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{myss}{\ }\hlassignement{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlstring{"{}50"{}}\hlkeyword{,}{\ }\hlstring{"{}100"{}}\hlkeyword{,}{\ }\hlstring{"{}200"{}}\hlkeyword{,}{\ }\hlstring{"{}500"{}}\hlkeyword{,}{\ }\hlstring{"{}1000"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{bws}{\ }\hlassignement{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{2.5}\hlkeyword{,}{\ }\hlnumber{2.5}\hlkeyword{,}{\ }\hlnumber{5}\hlkeyword{,}{\ }\hlnumber{5}\hlkeyword{,}{\ }\hlnumber{10}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{myssi}{\ }\hlassignement{=}{\ }\hlstring{"{}1000"{}}\hspace*{\fill}\\
\hlstd{}\hlkeyword{for}{\ }\hlkeyword{(}\hlsymbol{myssi}{\ }\hlkeyword{in}{\ }\hlsymbol{myss}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }\hlfunctioncall{beanplot}\hlkeyword{(}\hlsymbol{MetricOutput}\hlkeyword{[}{\ }\hlsymbol{myssi}\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlsymbol{mymetrics}\hlkeyword{[}\hlnumber{1}\hlkeyword{]}\hlkeyword{,}{\ }\hlstring{"{}bandwidths"{}}\hlkeyword{]}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlsymbol{MetricOutput}\hlkeyword{[}{\ }\hlsymbol{myssi}\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlsymbol{mymetrics}\hlkeyword{[}\hlnumber{2}\hlkeyword{]}\hlkeyword{,}{\ }\hlstring{"{}bandwidths"{}}\hlkeyword{]}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlsymbol{MetricOutput}\hlkeyword{[}{\ }\hlsymbol{myssi}\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlsymbol{mymetrics}\hlkeyword{[}\hlnumber{3}\hlkeyword{]}\hlkeyword{,}{\ }\hlstring{"{}bandwidths"{}}\hlkeyword{]}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlsymbol{MetricOutput}\hlkeyword{[}{\ }\hlsymbol{myssi}\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlsymbol{mymetrics}\hlkeyword{[}\hlnumber{4}\hlkeyword{]}\hlkeyword{,}{\ }\hlstring{"{}bandwidths"{}}\hlkeyword{]}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{what}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{1}\hlkeyword{,}{\ }\hlnumber{1}\hlkeyword{,}{\ }\hlnumber{0}\hlkeyword{)}{\ }\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{log}{\ }\hlargument{=}{\ }\hlstring{"{}"{}}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{bw}{\ }\hlargument{=}{\ }\hlsymbol{bws}\hlkeyword{[}\hlfunctioncall{which}\hlkeyword{(}\hlsymbol{myss}{\ }=={\ }\hlsymbol{myssi}\hlkeyword{)}\hlkeyword{]}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{cutmin}{\ }\hlargument{=}{\ }\hlnumber{5}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{cutmax}{\ }\hlargument{=}{\ }\hlfunctioncall{as.numeric}\hlkeyword{(}\hlsymbol{myssi}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{ylim}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlfunctioncall{as.numeric}\hlkeyword{(}\hlsymbol{myssi}\hlkeyword{)}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{xlim}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{0.5}\hlkeyword{,}{\ }\hlnumber{4.5}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{names}{\ }\hlargument{=}{\ }\hlnumber{FALSE}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{main}{\ }\hlargument{=}{\ }\hlfunctioncall{paste}\hlkeyword{(}\hlstring{"{}Sample{\ }Size{\ }={\ }"{}}\hlkeyword{,}{\ }\hlsymbol{myssi}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{ylab}{\ }\hlargument{=}{\ }\hlstring{"{}"{}}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlfunctioncall{list}\hlkeyword{(}\hlargument{col}{\ }\hlargument{=}{\ }\hlsymbol{mypal}\hlkeyword{[}\hlnumber{1}\hlkeyword{]}\hlkeyword{,}{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlsymbol{mypal}\hlkeyword{[}\hlnumber{2}\hlkeyword{]}\hlkeyword{,}{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlsymbol{mypal}\hlkeyword{[}\hlnumber{3}\hlkeyword{]}\hlkeyword{,}{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlsymbol{mypal}\hlkeyword{[}\hlnumber{4}\hlkeyword{]}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{axes}{\ }\hlargument{=}{\ }\hlnumber{FALSE}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }\hlfunctioncall{mtext}\hlkeyword{(}\hlsymbol{mymetrics}\hlkeyword{,}{\ }\hlnumber{1}\hlkeyword{,}{\ }\hlargument{line}{\ }\hlargument{=}{\ }\hlnumber{0}\hlkeyword{,}{\ }\hlargument{at}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{4}\hlkeyword{,}{\ }\hlargument{col}\hlargument{=}{\ }\hlsymbol{mypal}\hlkeyword{,}{\ }\hlargument{font}{\ }\hlargument{=}{\ }\hlnumber{2}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }\hlfunctioncall{mtext}\hlkeyword{(}\hlstring{"{}\usebox{\hlnormalsizeboxbackslash}\usebox{\hlnormalsizeboxbackslash}\usebox{\hlnormalsizeboxhash}{\ }of{\ }obs{\ }in{\ }LWR{\ }bandwidth"{}}\hlkeyword{,}{\ }\hlnumber{2}\hlkeyword{,}{\ }\hlargument{line}{\ }\hlargument{=}{\ }\hlnumber{3}\hlkeyword{,}{\ }\hlargument{cex}{\ }\hlargument{=}{\ }\hlnumber{.8}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }\hlfunctioncall{axis}\hlkeyword{(}\hlnumber{2}\hlkeyword{,}{\ }\hlargument{las}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }\hlfunctioncall{mtext}\hlkeyword{(}\hlstring{"{}Bandwidth{\ }Distributions{\ }by{\ }Metric{\ }and{\ }Sample{\ }Sizes"{}}\hlkeyword{,}{\ }\hlnumber{3}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{outer}{\ }\hlargument{=}{\ }\hlnumber{TRUE}\hlkeyword{,}{\ }\hlargument{line}{\ }\hlargument{=}{\ }\hlnumber{0}\hlkeyword{,}{\ }\hlargument{cex}{\ }\hlargument{=}{\ }\hlnumber{1.5}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\mbox{}
\normalfont
\end{flushleft}
\end{kframe}\begin{figure}[]
\includegraphics{figure/beanplots} \caption[Hello World]{Hello World. This is a figure caption. I am going to keep writing for a bit to see what happens if I just keep writing and writing. What is the point of this graphic? You will find that out right here.\label{fig:beanplots}}
\end{figure}

\end{knitrout}


Notice that the distributions of selected bandwidths are similar for the CV, GCV, and AICc metrics, while the SCV metric distribution stands out, especially at higher bandwidths. Additionally, note that most distributions have a cluster of selected bandwidths near the sample size. Given that one simulation parameterization included no spatial variation within the data generation coefficients, it makes sense to see a cluster of large bandwidths, a model specification that approaches Ordinary Least Squares. We now proceed to show the distributions by degree of spatial variation in the model coefficients. Figure \ref{fig:beanplots}.

\subsection{By Degree of Coefficient Variation}

Challenge: We used four different levels of spatial variation in each of our two model coefficients, giving us a total of 16 spatial variation cases.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }The{\ }goal{\ }of{\ }this{\ }code{\ }is{\ }to{\ }make{\ }a{\ }4{\ }x{\ }4{\ }gird{\ }of{\ }beanplots{\ }showing{\ }the{\ }distributions{\ }of{\ }optimal{\ }bandwidths{\ }across{\ }the{\ }four{\ }different{\ }LWR{\ }metrics{\ }and{\ }the{\ }combinations{\ }of{\ }Bsv{\ }parameters.{\ }}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{require}\hlkeyword{(}\hlsymbol{RColorBrewer}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{require}\hlkeyword{(}\hlsymbol{beanplot}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{mypal}{\ }\hlassignement{=}{\ }\hlfunctioncall{brewer.pal}\hlkeyword{(}\hlnumber{4}\hlkeyword{,}{\ }\hlstring{"{}Set2"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }set{\ }some{\ }figure{\ }margin{\ }parameters}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlsymbol{my.B1}{\ }\hlassignement{=}{\ }\hlsymbol{my.B2}{\ }\hlassignement{=}{\ }\hlnumber{1}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlsymbol{df}{\ }\hlassignement{=}{\ }\hlfunctioncall{layout}\hlkeyword{(}{\ }\hlfunctioncall{matrix}\hlkeyword{(}\hlfunctioncall{c}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlfunctioncall{rep}\hlkeyword{(}\hlnumber{17}\hlkeyword{,}{\ }\hlnumber{4}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlnumber{18}\hlkeyword{,}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{4}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlnumber{18}\hlkeyword{,}{\ }\hlnumber{5}\hlkeyword{:}\hlnumber{8}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlnumber{18}\hlkeyword{,}{\ }\hlnumber{9}\hlkeyword{:}\hlnumber{12}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlnumber{18}\hlkeyword{,}{\ }\hlnumber{13}\hlkeyword{:}\hlnumber{16}\hlkeyword{)}\hlkeyword{,}{\ }\hlnumber{5}\hlkeyword{,}{\ }\hlnumber{5}\hlkeyword{,}{\ }\hlargument{byrow}{\ }\hlargument{=}{\ }\hlsymbol{T}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{widths}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{.6}\hlkeyword{,}{\ }\hlfunctioncall{rep}\hlkeyword{(}\hlnumber{1}\hlkeyword{,}{\ }\hlnumber{4}\hlkeyword{)}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{heights}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{.6}\hlkeyword{,}{\ }\hlfunctioncall{rep}\hlkeyword{(}\hlnumber{1}\hlkeyword{,}{\ }\hlnumber{4}\hlkeyword{)}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}layout.show(df)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlsymbol{myssi}{\ }\hlassignement{=}{\ }\hlstring{"{}1000"{}}\hspace*{\fill}\\
\hlstd{}\hlsymbol{myss}{\ }\hlassignement{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlstring{"{}50"{}}\hlkeyword{,}{\ }\hlstring{"{}100"{}}\hlkeyword{,}{\ }\hlstring{"{}200"{}}\hlkeyword{,}{\ }\hlstring{"{}500"{}}\hlkeyword{,}{\ }\hlstring{"{}1000"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{mymetrics}{\ }\hlassignement{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlstring{"{}CV"{}}\hlkeyword{,}{\ }\hlstring{"{}GCV"{}}\hlkeyword{,}{\ }\hlstring{"{}SCV"{}}\hlkeyword{,}{\ }\hlstring{"{}AICc"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{bws}{\ }\hlassignement{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{2.5}\hlkeyword{,}{\ }\hlnumber{2.5}\hlkeyword{,}{\ }\hlnumber{5}\hlkeyword{,}{\ }\hlnumber{5}\hlkeyword{,}{\ }\hlnumber{10}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{par}\hlkeyword{(}\hlargument{oma}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{2.5}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{par}\hlkeyword{(}\hlargument{mar}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{.5}\hlkeyword{,}{\ }\hlnumber{.5}\hlkeyword{,}{\ }\hlnumber{.5}\hlkeyword{,}{\ }\hlnumber{.5}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlkeyword{for}{\ }\hlkeyword{(}\hlsymbol{my.B2}{\ }\hlkeyword{in}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{4}\hlkeyword{)}\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }four{\ }because{\ }there{\ }are{\ }four{\ }different{\ }B2sv{\ }parameter{\ }files}\hspace*{\fill}\\
\hlstd{}{\ }{\ }\hlkeyword{for}{\ }\hlkeyword{(}\hlsymbol{my.B1}{\ }\hlkeyword{in}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{4}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }four{\ }because{\ }there{\ }are{\ }four{\ }different{\ }B1sv{\ }parameter{\ }files}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }now{\ }make{\ }a{\ }beanplot{\ }for{\ }the{\ }given{\ }Bsv1{\ }and{\ }Bsv2}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{beanplot}\hlkeyword{(}\hlsymbol{MetricOutput}\hlkeyword{[}\hlsymbol{myssi}\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlsymbol{my.B1}\hlkeyword{,}{\ }\hlsymbol{my.B2}\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlsymbol{mymetrics}\hlkeyword{[}\hlnumber{1}\hlkeyword{]}\hlkeyword{,}{\ }\hlstring{"{}bandwidths"{}}\hlkeyword{]}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlsymbol{MetricOutput}\hlkeyword{[}\hlsymbol{myssi}\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlsymbol{my.B1}\hlkeyword{,}{\ }\hlsymbol{my.B2}\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlsymbol{mymetrics}\hlkeyword{[}\hlnumber{2}\hlkeyword{]}\hlkeyword{,}{\ }\hlstring{"{}bandwidths"{}}\hlkeyword{]}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlsymbol{MetricOutput}\hlkeyword{[}\hlsymbol{myssi}\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlsymbol{my.B1}\hlkeyword{,}{\ }\hlsymbol{my.B2}\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlsymbol{mymetrics}\hlkeyword{[}\hlnumber{3}\hlkeyword{]}\hlkeyword{,}{\ }\hlstring{"{}bandwidths"{}}\hlkeyword{]}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlsymbol{MetricOutput}\hlkeyword{[}\hlsymbol{myssi}\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlsymbol{my.B1}\hlkeyword{,}{\ }\hlsymbol{my.B2}\hlkeyword{,}{\ }\hlkeyword{,}{\ }\hlsymbol{mymetrics}\hlkeyword{[}\hlnumber{4}\hlkeyword{]}\hlkeyword{,}{\ }\hlstring{"{}bandwidths"{}}\hlkeyword{]}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{what}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{1}\hlkeyword{,}{\ }\hlnumber{1}\hlkeyword{,}{\ }\hlnumber{0}\hlkeyword{)}{\ }\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{log}{\ }\hlargument{=}{\ }\hlstring{"{}"{}}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{bw}{\ }\hlargument{=}{\ }\hlsymbol{bws}\hlkeyword{[}\hlfunctioncall{which}\hlkeyword{(}\hlsymbol{myss}{\ }=={\ }\hlsymbol{myssi}\hlkeyword{)}\hlkeyword{]}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{cutmin}{\ }\hlargument{=}{\ }\hlnumber{5}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{cutmax}{\ }\hlargument{=}{\ }\hlfunctioncall{as.numeric}\hlkeyword{(}\hlsymbol{myssi}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{ylim}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlfunctioncall{as.numeric}\hlkeyword{(}\hlsymbol{myssi}\hlkeyword{)}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}names{\ }={\ }mymetrics,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{axes}{\ }\hlargument{=}{\ }\hlnumber{FALSE}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{main}{\ }\hlargument{=}{\ }\hlstring{"{}"{}}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{ylab}{\ }\hlargument{=}{\ }\hlstring{"{}"{}}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlfunctioncall{list}\hlkeyword{(}\hlargument{col}{\ }\hlargument{=}{\ }\hlsymbol{mypal}\hlkeyword{[}\hlnumber{1}\hlkeyword{]}\hlkeyword{,}{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlsymbol{mypal}\hlkeyword{[}\hlnumber{2}\hlkeyword{]}\hlkeyword{,}{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlsymbol{mypal}\hlkeyword{[}\hlnumber{3}\hlkeyword{]}\hlkeyword{,}{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlsymbol{mypal}\hlkeyword{[}\hlnumber{4}\hlkeyword{]}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlkeyword{if}\hlkeyword{(}\hlsymbol{my.B1}{\ }=={\ }\hlnumber{1}\hlkeyword{)}{\ }\hlfunctioncall{axis}\hlkeyword{(}\hlnumber{2}\hlkeyword{,}{\ }\hlargument{las}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlkeyword{if}\hlkeyword{}\hlkeyword{(}\hlsymbol{my.B1}{\ }=={\ }\hlnumber{4}\hlkeyword{)}{\ }\hlfunctioncall{axis}\hlkeyword{(}\hlnumber{4}\hlkeyword{,}{\ }\hlargument{las}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\mbox{}
\normalfont
\end{flushleft}
\end{kframe}

\includegraphics[width=.9\textwidth]{figure/MegaFig1} \hfill{}

\begin{kframe}\begin{flushleft}
\ttfamily\noindent
\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }Now{\ }work{\ }on{\ }the{\ }column{\ }labels}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{par}\hlkeyword{(}\hlargument{mar}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{0}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{spots}{\ }\hlassignement{=}{\ }\hlfunctioncall{seq}\hlkeyword{(}\hlnumber{.125}\hlkeyword{,}{\ }\hlnumber{.875}\hlkeyword{,}{\ }\hlargument{l}{\ }\hlargument{=}{\ }\hlnumber{4}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{plot}\hlkeyword{(}\hlnumber{1}\hlkeyword{,}{\ }\hlargument{xaxs}\hlargument{=}\hlstring{"{}i"{}}\hlkeyword{,}{\ }\hlargument{xlim}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{1}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{yaxs}{\ }\hlargument{=}{\ }\hlstring{"{}i"{}}\hlkeyword{,}{\ }\hlargument{ylim}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{1}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{type}{\ }\hlargument{=}{\ }\hlstring{"{}n"{}}\hlkeyword{,}{\ }\hlargument{axes}{\ }\hlargument{=}{\ }\hlsymbol{F}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{axis}\hlkeyword{(}\hlnumber{1}\hlkeyword{,}{\ }\hlargument{line}{\ }\hlargument{=}{\ }\hlkeyword{-}\hlnumber{2}\hlkeyword{,}{\ }\hlargument{at}{\ }\hlargument{=}{\ }\hlsymbol{spots}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }\hlargument{labels}{\ }\hlargument{=}{\ }\hlsymbol{F}\hlkeyword{,}{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlstring{"{}red"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{text}\hlkeyword{(}\hlsymbol{spots}\hlkeyword{,}{\ }\hlfunctioncall{rep}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{4}\hlkeyword{)}\hlkeyword{,}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlstring{"{}none"{}}\hlkeyword{,}{\ }\hlstring{"{}some"{}}\hlkeyword{,}{\ }\hlstring{"{}more"{}}\hlkeyword{,}{\ }\hlstring{"{}most"{}}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlstring{"{}red"{}}\hlkeyword{,}{\ }\hlargument{pos}{\ }\hlargument{=}{\ }\hlnumber{3}\hlkeyword{,}{\ }\hlargument{cex}{\ }\hlargument{=}{\ }\hlnumber{1.3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{text}\hlkeyword{(}\hlnumber{.5}\hlkeyword{,}{\ }\hlnumber{.4}\hlkeyword{,}{\ }\hlfunctioncall{expression}\hlkeyword{(}\hlfunctioncall{paste}\hlkeyword{(}\hlstring{"{}Degree{\ }of{\ }Spatial{\ }Variation{\ }in{\ }"{}}\hlkeyword{,}{\ }\hlsymbol{beta}\hlkeyword{[}\hlnumber{1}\hlkeyword{]}\hlkeyword{)}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlstring{"{}red"{}}\hlkeyword{,}{\ }\hlargument{cex}{\ }\hlargument{=}{\ }\hlnumber{1.5}\hlkeyword{,}{\ }\hlargument{font}{\ }\hlargument{=}{\ }\hlnumber{2}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}points((0:100)/100,{\ }rep(0,{\ }101),{\ }col{\ }={\ }c("{}red"{},{\ }rep("{}black"{},{\ }9)))}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }Now{\ }work{\ }on{\ }the{\ }row{\ }labels}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{plot}\hlkeyword{(}\hlnumber{1}\hlkeyword{,}{\ }\hlargument{xaxs}\hlargument{=}\hlstring{"{}i"{}}\hlkeyword{,}{\ }\hlargument{xlim}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{1}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{yaxs}{\ }\hlargument{=}{\ }\hlstring{"{}i"{}}\hlkeyword{,}{\ }\hlargument{ylim}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{0}\hlkeyword{,}{\ }\hlnumber{1}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{type}{\ }\hlargument{=}{\ }\hlstring{"{}n"{}}\hlkeyword{,}{\ }\hlargument{axes}{\ }\hlargument{=}{\ }\hlsymbol{F}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{axis}\hlkeyword{(}\hlnumber{4}\hlkeyword{,}{\ }\hlargument{line}{\ }\hlargument{=}{\ }\hlkeyword{-}\hlnumber{5}\hlkeyword{,}{\ }\hlargument{at}{\ }\hlargument{=}{\ }\hlsymbol{spots}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }\hlargument{labels}{\ }\hlargument{=}{\ }\hlsymbol{F}\hlkeyword{,}{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlstring{"{}red"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{text}\hlkeyword{(}\hlfunctioncall{rep}\hlkeyword{(}\hlnumber{.5}\hlkeyword{,}{\ }\hlnumber{4}\hlkeyword{)}\hlkeyword{,}{\ }\hlsymbol{spots}\hlkeyword{,}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlstring{"{}most"{}}\hlkeyword{,}{\ }\hlstring{"{}more"{}}\hlkeyword{,}{\ }\hlstring{"{}some"{}}\hlkeyword{,}{\ }\hlstring{"{}none"{}}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlstring{"{}red"{}}\hlkeyword{,}{\ }\hlargument{cex}{\ }\hlargument{=}{\ }\hlnumber{1.3}\hlkeyword{,}{\ }\hlargument{srt}{\ }\hlargument{=}{\ }\hlnumber{90}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{text}\hlkeyword{(}\hlnumber{.2}\hlkeyword{,}{\ }\hlnumber{.5}\hlkeyword{,}{\ }\hlfunctioncall{expression}\hlkeyword{(}\hlfunctioncall{paste}\hlkeyword{(}\hlstring{"{}Degree{\ }of{\ }Spatial{\ }Variation{\ }in{\ }"{}}\hlkeyword{,}{\ }\hlsymbol{beta}\hlkeyword{[}\hlnumber{2}\hlkeyword{]}\hlkeyword{)}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlstring{"{}red"{}}\hlkeyword{,}{\ }\hlargument{cex}{\ }\hlargument{=}{\ }\hlnumber{1.5}\hlkeyword{,}{\ }\hlargument{srt}{\ }\hlargument{=}{\ }\hlnumber{90}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }Title{\ }and{\ }Legend}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{mtext}\hlkeyword{(}\hlfunctioncall{paste}\hlkeyword{(}\hlstring{"{}Bandwidth{\ }Distributions{\ }by{\ }Metric{\ }and{\ }Degree{\ }of{\ }Spatial{\ }Variation"{}}\hlkeyword{)}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{outer}{\ }\hlargument{=}{\ }\hlnumber{TRUE}\hlkeyword{,}{\ }\hlargument{line}{\ }\hlargument{=}{\ }\hlkeyword{-}\hlnumber{2.5}\hlkeyword{,}{\ }\hlargument{side}{\ }\hlargument{=}{\ }\hlnumber{3}\hlkeyword{,}{\ }\hlargument{font}{\ }\hlargument{=}{\ }\hlnumber{2}\hlkeyword{,}{\ }\hlargument{cex}{\ }\hlargument{=}{\ }\hlnumber{1.5}\hlkeyword{,}{\ }\hlargument{at}{\ }\hlargument{=}{\ }\hlnumber{.52}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{mtext}\hlkeyword{(}\hlfunctioncall{c}\hlkeyword{(}\hlstring{"{}Metric{\ }="{}}\hlkeyword{,}{\ }\hlstring{"{}CV"{}}\hlkeyword{,}{\ }\hlstring{"{}GCV"{}}\hlkeyword{,}{\ }\hlstring{"{}SCV"{}}\hlkeyword{,}{\ }\hlstring{"{}AICc"{}}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{outer}{\ }\hlargument{=}{\ }\hlnumber{TRUE}\hlkeyword{,}{\ }\hlargument{line}{\ }\hlargument{=}{\ }\hlkeyword{-}\hlnumber{21}\hlkeyword{,}{\ }\hlargument{side}{\ }\hlargument{=}{\ }\hlnumber{3}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{cex}{\ }\hlargument{=}{\ }\hlnumber{.8}\hlkeyword{,}{\ }\hlargument{at}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{.3}\hlkeyword{,}{\ }\hlnumber{.375}\hlkeyword{,}{\ }\hlnumber{.41}\hlkeyword{,}{\ }\hlnumber{.46}\hlkeyword{,}{\ }\hlnumber{.508}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{adj}{\ }\hlargument{=}{\ }\hlnumber{0}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }\hlargument{col}{\ }\hlargument{=}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlstring{"{}black"{}}\hlkeyword{,}{\ }\hlsymbol{mypal}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{font}{\ }\hlargument{=}{\ }\hlnumber{2}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\end{kframe}

\includegraphics[width=.9\textwidth]{figure/MegaFig2} \hfill{}


\end{knitrout}




\section{How Accurate Are the Coefficient Estimates?}

Rather than just looking at the bandwidths selected, researchers are probably more interested in the accuracy of the model predictions, specifically with regard to the model coefficients. In particular, does LWR tend to overfit the data by choosing small bandwidths and spurious coefficients? In this section we compare the estimated model coefficients to the true model coefficients to better understand the reliability of the LWR procedure.


\section{What Happens When the Model is Misspecified?}

In previous sections we assumed that the model to be estimated using LWR was properly specified. That is, bothe variables ($X_1$ and $X_2$) are included and their coefficients are allowed to vary over space to reflect the true data generation process. This section relaxes the assumption of a perfectly specified model and omits one variable in the regression. Our new regression equation becomes:
\begin{equation}
y = \alpha (location) + \beta _1 (location) X_1 + error
\end{equation}

An important question to consider in these circumstances is, ``What happens when the omitted variable had a spatially varying coefficient, but the included variable coefficients are stationary?'' Does LWR choose a large bandwidth and reflect the stationarity of the included model parameters? Does LWR select a small bandwidth and estimate spatially varying intercept terms? If so, what are the impacts on our estimates of the stationary parameter?



\end{document}
